<div class="container border-1 mt-5">
  <div class="row">
    <div class="col-lg-6 mx-auto">
      <h1 class="mb-4">Chats</h1>
      
      <%= form_with url: conversations_path, class: "mb-4" do |form| %>
        <div class="input-group mb-3">
          <%= form.label :receiver_id, "Start a conversation with:", class: "input-group-text" %>
          <%= form.collection_select :receiver_id, User.where.not(id: current_user.id), :id, :email, { prompt: true }, class: "form-control" %>
          <%= form.hidden_field :sender_id, value: current_user.id %>
          <button type="submit" class="btn btn-primary">Start Chat</button>
        </div>
      <% end %>

      <div class="list-group">
        <% @conversations.each do |conversation| %>
          <%= link_to conversation_messages_path(conversation), class: "list-group-item list-group-item-action d-flex justify-content-between align-items-center" do %>
            <% if conversation.sender_id == current_user.id %>
              Chat with <%= conversation.receiver.email %>
            <% else %>
              Chat with <%= conversation.sender.email %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
